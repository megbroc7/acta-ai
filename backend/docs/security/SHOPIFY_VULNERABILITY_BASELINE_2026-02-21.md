# Shopify Vulnerability Baseline + Dependency Chain Map (2026-02-21)

Scope:
- Shopify app only (`/Users/meganbroccoli/Desktop/Sabina/Web Services/Acta AI/shopify-app/acta-blog-publisher`)
- Baseline capture only (no dependency upgrades in this step)

## 1. Raw Audit Artifacts

- Full audit JSON:
  - `/Users/meganbroccoli/Desktop/Sabina/Web Services/Acta AI/backend/docs/security/npm-audit-shopify-app-2026-02-21.json`
- Production-only audit JSON:
  - `/Users/meganbroccoli/Desktop/Sabina/Web Services/Acta AI/backend/docs/security/npm-audit-shopify-app-prodonly-2026-02-21.json`

Commands used:

```bash
cd "/Users/meganbroccoli/Desktop/Sabina/Web Services/Acta AI/shopify-app/acta-blog-publisher"
npm audit --json > "/Users/meganbroccoli/Desktop/Sabina/Web Services/Acta AI/backend/docs/security/npm-audit-shopify-app-2026-02-21.json"
npm audit --omit=dev --json > "/Users/meganbroccoli/Desktop/Sabina/Web Services/Acta AI/backend/docs/security/npm-audit-shopify-app-prodonly-2026-02-21.json"
```

## 2. Baseline Counts

From `metadata.vulnerabilities`:

- Full audit:
  - total: `35`
  - high: `28`
  - moderate: `7`
  - low/info/critical: `0`
- Production-only audit (`--omit=dev`):
  - total: `12`
  - high: `6`
  - moderate: `6`
  - low/info/critical: `0`

## 3. Production High/Critical Findings

From `npm-audit-shopify-app-prodonly-2026-02-21.json`:

| package | severity | vulnerable range | fix available | via |
|---|---|---|---|---|
| `@npmcli/package-json` | high | `3.1.0 - 6.2.0` | `false` | `glob` |
| `@remix-run/dev` | high | `*` | `false` | `@npmcli/package-json`, `@vanilla-extract/integration`, `cacache`, `esbuild`, `minimatch`, `remark-mdx-frontmatter` |
| `cacache` | high | `6.1.1 - 19.0.1` | `true` | `glob`, `tar` |
| `glob` | high | `3.0.0 - 10.5.0` | `false` | `minimatch` |
| `minimatch` | high | `<10.2.1` | `false` | `1113371` |
| `tar` | high | `<=7.5.7` | `true` | `1112329`, `1112659`, `1113300`, `1113375` |

## 4. Dependency Chain Map (Production Focus)

Resolved using:

```bash
npm ls @remix-run/dev @npmcli/package-json cacache glob minimatch tar --all --omit=dev
```

Output:

```text
acta-blog-publisher@
├─┬ @remix-run/dev@2.17.4
│ ├─┬ @npmcli/package-json@4.0.1
│ │ └─┬ glob@10.5.0
│ │   └── minimatch@9.0.5 deduped
│ ├─┬ cacache@17.1.4
│ │ ├── glob@10.5.0 deduped
│ │ └── tar@6.2.1
│ └── minimatch@9.0.5 overridden
└─┬ @remix-run/fs-routes@2.17.4
  ├── @remix-run/dev@2.17.4 deduped
  └─┬ @remix-run/route-config@2.17.4
    └── @remix-run/dev@2.17.4 deduped
```

Interpretation:
- The production high-severity chain is anchored on direct dependency `@remix-run/dev@2.17.4`.
- `glob`, `minimatch`, `cacache`, `tar`, and `@npmcli/package-json` are transitive off `@remix-run/dev`.
- Two `glob` paths exist under `@remix-run/dev`: via `@npmcli/package-json` and via `cacache`.
